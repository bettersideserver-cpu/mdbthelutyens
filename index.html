<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MDB Lutyen</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="JS/towerpins.css">
    <link rel="stylesheet" href="JS/Notification/ControllerCSS.css">
    <style>
        .mdb {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .pdf-icon {
            width: 50px;
            /* adjust size as needed */
            height: auto;
            object-fit: contain;
        }

        .fallback-text {
            margin-left: 6px;
            font-weight: 600;
            color: white;
        }

        .info-card {
            top: -100px;
            left: -50px;
            position: fixed;
            background-color: transparent;
            /* No blocking layer */
            display: none;
            z-index: 8999;
            pointer-events: none;
            /* ❗️ This makes whole container non-interactive except children */
            transform: scale(.9);
        }

        @media (max-width: 600px) {

            .info-card,
            .info-content {
                transform: scale(0.7);
                top: -50px;
                left: -30px;
            }
        }
    </style>
</head>

<body>
    <!-- Quick interaction hint (appears for ~2–3s) -->
    <div id="ui-hint" class="ui-hint" aria-live="polite" role="status">
        <!-- shown on mouse/trackpad devices -->
        <div class="ui-hint__row ui-hint__desktop">
            <!-- mouse icon (inline SVG) -->
            <svg width="18" height="24" viewBox="0 0 18 24" aria-hidden="true">
                <path d="M9 1c3.9 0 7 3.1 7 7v8c0 3.9-3.1 7-7 7s-7-3.1-7-7V8c0-3.9 3.1-7 7-7z" fill="white"
                    opacity=".18" />
                <rect x="8" y="4" width="2" height="5" rx="1" fill="white" />
                <rect x="5" y="10" width="8" height="9" rx="4" fill="white" opacity=".4" />
            </svg>
            <span>Click Tower's to Select Floors</span>
        </div>

        <!-- shown on touch devices -->
        <div class="ui-hint__row ui-hint__touch">
            <!-- finger icon (inline SVG) -->
            <svg width="18" height="24" viewBox="0 0 24 24" aria-hidden="true">
                <path
                    d="M12 2a4 4 0 014 4v4h1.2a2.8 2.8 0 012.8 2.8V16c0 3.3-2.7 6-6 6H9.5A5.5 5.5 0 014 16.5V11a3 3 0 016 0v3h1V6a4 4 0 011-2.7z"
                    fill="white" opacity=".28" />
                <rect x="11" y="5" width="2" height="9" rx="1" fill="white" />
            </svg>
            <span>Click on Tower's To Select Floor</span>
        </div>
    </div>


    <!-- <div class="context-chip" id="projectTag" aria-hidden="true">
        <div class="mdb">
            <img src="images/Thumbnail/MDB-logo.png" alt="MDB Logo" class="pdf-icon"
                onload="this.nextElementSibling.style.display='none'" />
            <span class="fallback-text">MDB</span>
        </div>
        <div class="lutyen">Lutyen Residence</div>
    </div> -->





    <!-- Info Card Modal -->
    <div id="infoCard" class="info-card">
        <div class="info-content">

            <h2 id="modalTitle">Tower_A</h2>

            <div class="image-placeholder">
                <img src="images/Thumbnail/Tower_A.webp" alt="Tower A" />
            </div>
            <div class="info-details" id="details"></div>
            <button class="explore-btn" id="navigateButton">Explore</button>
        </div>
    </div>


    <div class="Front">
        <div class="image-wrapper">
            <link rel="preload" as="image" href="images/Home.jpg" />

            <img id="mainImage" src="images/Thumbnail/Home_Low.webp" data-full="images/Home.jpg" alt="Home"
                fetchpriority="high" decoding="async" width="3840" height="5830" class="blur-up" />
            <div class="Cutout">
                <svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="0 0 3840 5830">
                    <path id="Tower_A" data-link="Tower_A.html" data-name="Tower_A"
                        data-img="images/Thumbnail/Tower_A.jpg"
                        d="m693.2 2402 46.7 22.7 16.2 812.4 19.8 13.1v26.2l-29.5 13.8 109.1 57.7 165.1-65.1 5.3 3.3 43.3-16.7-.7-9.9-2.2-.2-.4-21.8 9-4.4v10.3l7.2-2.2-1.2-10.8 33.8-14.1-.6 11.1 6.9-2-1.1-11.2 50.8-21.3v9.5l7.4-1.3-1-9.9 52.8-22.6v9.6l7.5-1.4-.3-11.6 31.4-12.9.8 9.4 6.2-1v-11.4l26.7-10.8v10.3l6.9-1.2v-11.8l4.4-.4-1.2 15.2 20.2 7.8 39.7-14.8-1.3-34.6 101.9-42 .4 8.8 6.5-.3v-11.1l52.1-21.5.6 9.2 7.3-1.5v-10.8l29.3-12.4v9.2l7.3-1.2v-10.9l26.5-11.2v9.1l5.6-.3v-11l4.9-3.9-.8 18.9 17.4 8.2 42.2-18.5-.4-9.4-2.1-.2.3-21.4 10-3.3-1.1 9.1 6.5-1.9-1.3-9.8 31.6-12.8-.4 9.1 6.7-1.2v-10.1l77.2-33.3V2294l-110.9-70 .1-77.9 73.8-30.8-48.7-35.2-112.6-53.2-862.5 340.4z"
                        class="st0" />
                    <path id="Tower_B" data-link="Tower_B.html" data-name="Tower_B"
                        data-img="images/Thumbnail/Tower_B.jpg"
                        d="m2025.4 2345.6-55.1 33.2 52 24.7v36.6l-52.8 22.7 6.3 3.8-.6 8.2-5.2 1v3.9l6 1.2-2.7 82.1-56.8-23.5-10.7 2-1.8-6.3-7.7-.3v-3.5l.8-3.8-1.8-1.3-2.8-5.3v-3.3s-3.7-1.3-4.3-1.7c-.7-.3-6.5-5.5-6.5-5.5l-6.8 2-6.5 4-3.2 4v6.8l-5.8 6.3-4.8 8.3-4 6.2-6.7 6.5v16.8l-4.5 1.3v4.5h-5.5l-1.3 3.7 2.7 646.7 18.6 9.8-.1 15.2 9.6-.5.2-9.9 43.6 23.5-.4 14.4 9.5-3-.1-8.2 30.3 14.6 29.2-12.4-2 31 35.9 18.1-.4-6.2 45.6 22.8-.7 13.8h9.4l1.4-9 43.9 21.2-1.4 15.8 9.3-3 1.1-7.2 37.4 19-.8 14.6 5 1.3 1-13.8 48.5 23.6v14.4h8.8l.4-10.1 4.6 2.6-.2 10.3 3.1.6v-10.3l7.1 5-.7 10.9h8.3l-1.7-9.1 10.9 5.3 29.7-12.4-2.2 31.3 82 35.9-.3 14.4 9.9-.8.9-9.7 44.8 23.9-.7 15.3 7-3.4.4-9.3 40.7 20.6.6 16.3 8.9-3.8-.8-8.3 45.3 22.6v15.9l9.9-4-1-7.7s32 16.1 32.4 16.1 30.7-13.6 30.7-13.6l-1.9 32.6 36.1 17.6v-4.6l46.7 23.3 1.2 15.8 9.2-2.3.4-8.3 49.3 23.6.4-11.3-3.3-6.7-8-4.4-.6-3.9 9-3.1.7-3.8-1.7-5.8 4.8-4.5 2-3.8 8.9-4.6s13.9 4 14.2 4 6.8 1.7 6.8 1.7l198.1-88.1v-4.7l4.4-8.2 7.3-3.6 9.8 2.9 8-1.3 16-6 13.2-646.8v-2.7l4.3-9.2s-3.5-4.7-4-5-4.8-2.3-4.8-2.3l-5.3-4.3-5.5-3.5s-9.7-4.3-10.5-4.3-1.8-.5-4.7-.8c-2.8-.3-4.2-5.5-4.2-5.5l-9.5-2-11.8-11-17.5-3-7.3 2.3s-6-6.5-6.8-6.5-12.2 8.7-12.2 8.7-11.7 5.2-12.5 5.2-2.3 8.5-2.3 8.5l-29.7-9.3-3-5.5-1.7-5.8-.5-121.3 4.8-2.2-.7-3.6-4.2-.5v-8.4h3.8l2.2-6.9 5.9-5.6-46.7-33.8 5.8-2.4v-5.6l-706.4-325.1-110.7 45.4z"
                        class="st0" />
                </svg>
                <!-- New: overlay that sits exactly on top of the image -->

            </div>
        </div>
    </div>
    <!-- Hotspot overlay (empty container, JS will size/position it) -->
    <div class="hs-layer" id="hsLayer">
        <!-- Example hotspots: use % relative to the image -->
        <button class="hs-dot" style="top:60%; left:43%;" onclick="location.href='SubPages/GodEye/Garden.html'">
            <img src="images/360_img.png" alt="Garden">
        </button>

        <button class="hs-dot" style="top:58%; left:25%;" onclick="location.href='SubPages/GodEye/Pool.html'">
            <img src="images/360_img.png" alt="Pool">
        </button>

        <button class="hs-dot" style="top:55%; left:43%;" onclick="location.href='SubPages/GodEye/SidePath.html'">
            <img src="images/360_img.png" alt="Side Path">
        </button>

        <button class="hs-dot" style="top:66.5%; left:84%;" onclick="location.href='SubPages/GodEye/Commercial.html'">
            <img src="images/360_img.png" alt="Commercial">
        </button>
    </div>
    <!-- Bottom Center Panel -->
    <nav class="jumpbar" role="navigation" aria-label="Quick jumps">
        <div class="jumpbar-inner">
            <button class="jumpchip" onclick="location.href='SubPages/GodEye/Garden.html'">Garden</button>
            <button class="jumpchip" onclick="location.href='SubPages/GodEye/SidePath.html'">SidePath</button>
            <button class="jumpchip" onclick="location.href='SubPages/GodEye/Pool.html'">Pool</button>
            <button class="jumpchip" onclick="location.href='SubPages/GodEye/Commercial.html'">Commercial</button>
            <button class="jumpchip" onclick="location.href='SubPages/Tower_A.html'">Tower A</button>
            <button class="jumpchip" onclick="location.href='SubPages/Tower_B.html'">Tower B</button>
            <!-- add more as you like -->
        </div>
    </nav>

    <script src="JS/TowerPins.js"></script>
    <script>
        window.addEventListener('DOMContentLoaded', () => {
            const paths = document.querySelectorAll('.Cutout path');
            const modal = document.getElementById('infoCard');
            const modalTitle = document.getElementById('modalTitle');
            const modalButton = document.getElementById('navigateButton');
            const imagePlaceholder = document.querySelector('.image-placeholder img');

            let selectedPath = null;
            let currentLink = '';

            // Handle path clicks
            paths.forEach(path => {
                const link = path.getAttribute('data-link');
                const name = path.getAttribute('data-name') || 'Building Info';

                if (link) {
                    path.addEventListener('click', (e) => {
                        e.stopPropagation();

                        // Deselect previously selected path
                        if (selectedPath && selectedPath !== path) {
                            selectedPath.classList.remove('selected');
                        }

                        selectedPath = path;
                        selectedPath.classList.add('selected');

                        // Update modal info
                        currentLink = `SubPages/${link}`;
                        modalTitle.textContent = name;

                        // 🔹 Load image dynamically based on data-name
                        const imagePath = `images/Thumbnail/${name}.webp`; // Example: images/Tower_A.jpg
                        imagePlaceholder.src = imagePath;
                        imagePlaceholder.alt = name;

                        // Show modal
                        modal.style.display = 'flex';
                    });
                }
            });

            // Navigate button click
            modalButton.addEventListener('click', () => {
                if (currentLink) {
                    window.location.href = currentLink;
                }
            });

            // Click outside modal to close
            document.addEventListener('click', (e) => {
                const isPath = e.target.closest('path');
                const isModal = e.target.closest('.info-content');
                if (!isPath && !isModal) {
                    modal.style.display = 'none';
                    if (selectedPath) {
                        selectedPath.classList.remove('selected');
                        selectedPath = null;
                    }
                    currentLink = '';
                    modalTitle.textContent = '~';
                }
            });
        });
    </script>



    <script>
        (function () {
            const img = document.querySelector('.image-wrapper img');
            const layer = document.getElementById('hsLayer');
            if (!img || !layer) return;

            // Read the actual on-screen rectangle of the image and pin the overlay to it
            function doSync() {
                const r = img.getBoundingClientRect();
                layer.style.top = r.top + 'px';
                layer.style.left = r.left + 'px';
                layer.style.width = r.width + 'px';
                layer.style.height = r.height + 'px';
            }

            // Run the sync AFTER layout has fully settled
            function syncAfterLayout() {
                requestAnimationFrame(() => requestAnimationFrame(doSync));
            }

            // Initial syncs
            if (img.complete) syncAfterLayout();
            else img.addEventListener('load', syncAfterLayout, { once: true });
            window.addEventListener('load', syncAfterLayout, { once: true });

            // On resize / orientation
            window.addEventListener('resize', syncAfterLayout);
            window.addEventListener('orientationchange', () => {
                syncAfterLayout();
                // extra pass for mobile browsers that "settle" a moment later
                setTimeout(syncAfterLayout, 250);
            });

            // On aspect-ratio media query flips
            const mqPortrait = window.matchMedia('(max-aspect-ratio: 3840/5830)');
            const mqLandscape = window.matchMedia('(min-aspect-ratio: 3840/5830)');
            if (mqPortrait.addEventListener) {
                mqPortrait.addEventListener('change', syncAfterLayout);
                mqLandscape.addEventListener('change', syncAfterLayout);
            } else if (mqPortrait.addListener) { // Safari <14
                mqPortrait.addListener(syncAfterLayout);
                mqLandscape.addListener(syncAfterLayout);
            }

            // Watch the image box itself
            if ('ResizeObserver' in window) {
                new ResizeObserver(syncAfterLayout).observe(img);
            }
        })();
    </script>
    <script src="JS/Notification/Controller.js"></script>



    <script>
        window.addEventListener('DOMContentLoaded', () => {
            const mq = window.matchMedia('(max-width: 600px)');

            const desktopPositions = {
                Tower_A: { left: 35, top: 47 },
                Tower_B: { left: 59, top: 52 }
            };
            const mobilePositions = {
                Tower_A: { left: 35, top: 48 },
                Tower_B: { left: 58, top: 53 }
            };

            function runPins() {
                initTowerPins({
                    svgSelector: '.Cutout svg',
                    layerSelector: '#hsLayer',
                    viewBox: [3840, 5830],
                    positions: mq.matches ? mobilePositions : desktopPositions
                });
            }

            runPins();                   // initial
            mq.addEventListener?.('change', runPins);
            // Safari fallback:
            if (!mq.addEventListener) mq.addListener(runPins);

            // Also re-run after your image/layer sync settles (optional but safer)
            window.addEventListener('resize', () => requestAnimationFrame(runPins));
            window.addEventListener('orientationchange', () => setTimeout(runPins, 250));
        });
    </script>



    <script>
        window.addEventListener('DOMContentLoaded', () => {
            const paths = document.querySelectorAll('.Cutout path');
            const infoCard = document.getElementById('infoCard');
            const modalTitle = document.getElementById('modalTitle');
            const modalButton = document.getElementById('navigateButton');
            const detailsEl = document.getElementById('details');          // optional details container
            const imgEl = document.querySelector('.image-placeholder img'); // if you show an image

            let selectedPath = null;
            let currentLink = '';

            // 1) Configure content for each tower here
            const INFO = {
                Tower_A: {
                    title: 'Tower_A',
                    lowImg: 'images/Thumbnail/Icon/Tower_A.jpg',
                    img: 'images/Thumbnail/Icon/Tower_A.jpg',
                    link: 'SubPages/Tower_A.html',
                    detailsHTML: `
          <div><strong>Total Units:</strong> 112</div>
          <div><strong>Apartments:</strong> 107</div>
          <div><strong>Penthouse:</strong>5</div>
          <div><strong>Bedroom:</strong>3BHK+1</div>
        `
                },
                Tower_B: {
                    title: 'Tower_B',
                    lowImg: 'images/Thumbnail/Icon/Tower_B.jpg',
                    img: 'images/Thumbnail/Icon/Tower_B.jpg',
                    link: 'SubPages/Tower_B.html',
                    detailsHTML: `
          <div><strong>Total Units:</strong> 219</div>
          <div><strong>Apartments:</strong> 213</div>
          <div><strong>Penthouse:</strong>6</div>
          <div><strong>Bedroom:</strong>3BHK</div>
        `
                }
            };

            function setExploreState(hasLink) {
                if (!modalButton) return;
                modalButton.disabled = !hasLink;
                modalButton.style.opacity = hasLink ? '1' : '0.6';
                modalButton.style.pointerEvents = hasLink ? 'auto' : 'none';
                modalButton.title = hasLink ? '' : 'No page linked';
            }
            // scoped only to this script (modal image)
            function swapModalImage(imgEl, highSrc, lowSrc) {
                if (!imgEl || !highSrc) return;

                // optional low-res (fallback to placeholder if not provided)
                if (lowSrc) {
                    imgEl.src = lowSrc;
                }

                imgEl.classList.remove('is-loaded');   // reset blur state if reused
                imgEl.classList.add('blur-up');        // ensure blur-up style is applied

                const hi = new Image();
                hi.decoding = 'async';
                hi.src = highSrc;

                const done = () => {
                    imgEl.src = highSrc;
                    imgEl.classList.add('is-loaded');
                };

                if (typeof hi.decode === 'function') {
                    hi.decode().then(done).catch(done);
                } else {
                    hi.onload = done;
                    hi.onerror = done;
                }
            }

            // if you have a consistent low-res naming: file.ext -> file_Low.webp
            function toLowResPath(fullPath) {
                // tweak to match your actual low-res naming or return null to skip
                return fullPath.replace(/(\.\w+)$/, '_Low.webp');
            }

            function render(info) {
                // Title
                modalTitle.textContent = info.title || '~';

                // Image (only modal image is affected)
                if (imgEl && info.img) {
                    const high = info.img;
                    const low = toLowResPath(high); // or set to null if you don't keep _Low.webp files
                    imgEl.alt = info.title;
                    swapModalImage(imgEl, high, low);
                }

                // Details
                if (detailsEl) {
                    detailsEl.innerHTML = info.detailsHTML || '';
                }

                // Link
                currentLink = info.link || '';
                setExploreState(!!currentLink);

                // Show card
                infoCard.style.display = 'flex';
            }


            // 2) Wire up just the two paths
            paths.forEach(path => {
                path.addEventListener('click', (e) => {
                    e.stopPropagation();

                    // which tower?
                    const key = (path.getAttribute('data-name') || path.id || '').trim();
                    const info = INFO[key];
                    if (!info) return; // ignore any other paths

                    // selection styling
                    if (selectedPath && selectedPath !== path) selectedPath.classList.remove('selected');
                    path.classList.add('selected');
                    selectedPath = path;

                    render(info);
                });
            });

            // Explore -> navigate
            modalButton?.addEventListener('click', () => {
                if (currentLink) window.location.href = currentLink;
            });

            // Click outside -> close
            document.addEventListener('click', (e) => {
                const isPath = e.target.closest('path');
                const isModal = e.target.closest('.info-content');
                if (!isPath && !isModal) {
                    infoCard.style.display = 'none';
                    if (selectedPath) selectedPath.classList.remove('selected');
                    selectedPath = null;
                    currentLink = '';
                    modalTitle.textContent = '~';
                    setExploreState(false);
                }
            });
        });
    </script>

    <script src="JS/Image_Loader.js"></script>



    <script src="JS/Disbale-Inspect.js"></script>
</body>

</html>
